## 7.3.4 将对象保存到本地存储中／从本地存储中获取对象
&emsp;&emsp;可以保存到本地存储中的数据类型必须是字符串（虽然在规格上可以保存对象，但是现在的浏览器不支持）。虽然即使是保存对象也不会出错，但默认会使用toString方法将其转换为字符串，所以之后就不能将其还原为对象了。
##### 【383页】
![image](../../images/c7/スクリーンショット&#32;2019-04-12&#32;午後9.52.49.png)
**●直接将对象保存到本地存储中后的结果**

&emsp;&emsp;因此，如果要将对象保存到本地存储中，必须将其转换为「可以还原的字符串」。具体的做法如下。

**●清单7-18 storage_obj.js**
![image](../../images/c7/スクリーンショット&#32;2019-04-13&#32;午前11.04.36.png)
> '苹果' '青森'  
> // 结果：苹果

&emsp;&emsp;JSON.stringify方法（3.7.3）的功能（①）就是将对象转换为可以还原为对象的字符串。转换后的值像下面这样，和对象字面量很相似，所以可以直接保存到本地存储中。
```javascript
{name:"苹果", price: 150, made: "青森"}
```
&emsp;&emsp;取出数据时，将字符串传递给JSON.parse方法便可以还原为对象（②）。在③中，可以看到像data.name这样，可以访问各个属性了。

**■防止本地存储中的命名冲突**<br>
&emsp;&emsp;正如之前所接触到的，在Local Storage中，是以源为单位来管理数据的。特别是当一个源中有多个应用在运行时，为了防止命名冲突，推荐将1个应用中使用的数据存放在最多1个对象中。
##### 【384页】
![image](../../images/c7/スクリーンショット&#32;2019-04-13&#32;午前11.20.27.png)
> Key（键） Value（值）  
> 以应用为单位使用对象来管理数据  
> 即使有同名的key，但是因为在不同的对象中，所以是不同的

**●以应用为单位保存数据**

&emsp;&emsp;但是，存取值时需要转换对象会很麻烦，所以像下面这样提前定义MyStorage类的话会很方便。

**●清单7-19 MyStorage.js**
![image](../../images/c7/スクリーンショット&#32;2019-04-13&#32;午前11.33.19.png)
> // 应用名  
> // 使用的本地存储的种类（在这里是Local Storage）  
> // 从本地存储中读取的对象  
> // 如果没有对应的数据，生成空对象  
> // 使用指定的key获取值  
> // 使用指定的key／值替换对象  
> // 将MyStorage对象的内容保存到本地存储中

&emsp;&emsp;下面是使用MyStorage对象的例子。
##### 【385页】
**●清单7-20 storage_call.js**
![image](../../images/c7/スクリーンショット&#32;2019-04-13&#32;午前11.40.35.png)
> '霍格'  
> // 结果：霍格

&emsp;&emsp;请注意使用MyStorage时，仅仅调用setItem方法是不会将改动反映到本地存储中的。最终需要调用save方法才能反映到本地存储中。<br>
&emsp;&emsp;打开开发者工具，我们可以发现JSSample这个对象中的键为hoge的值确实保存下来了。
![image](../../images/c7/スクリーンショット&#32;2019-04-13&#32;午前11.50.17.png)
**●以应用为单位保存数据**